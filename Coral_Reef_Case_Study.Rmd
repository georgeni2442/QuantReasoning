---
title: "Coral_Reef_Case_Study"
author: "George Ni"
date: "10/14/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Question 1
![Crappy sketch of Individual Flow Diagram](Individual_Flow_Diagram.png)





# Question 2
Group Flow Diagram: 
![Group Flow Diagram](SES Coral Flow Chart.jpeg)





# Question 3
Flow Diagram: 
![Flow Diagram](Blank diagram.jpeg)
Parameters: 

* a represents competition between macro-algae and coral. 
* g represents competition between macro-algae and turf
* r represents competition between turf and coral
* d represents some death parameter for coral 




```{r echo=FALSE}
require(deSolve)

# Initial values
state <- c(M=10,P=10,T=10,C=10)
times <- seq(0,100,by=0.1)



# Parameters
parameters <- c(a = 0.1,g=0.8,r=1.0,d=0.44,s=0.49,K=10)


# Model
coral_model <- function(t,state,parameters){
  with(as.list(c(state,parameters)),{
    dM <- (a*M*C) -((P*M)/(M + T))+ (g*M*T)
    dC <- (r*T*C)-(d*C)-(a*M*C)
    dT <- ((P*M)/(M + T))-(g*M*T)-(r*T*C)+(d*C)
    dP <- (s*P)*(1-(P/K))
    list(c(dM,dC,dT,dP))   
  })}
```



```{r}
# Model and plot results
out <- ode(y = state,times=times,func=coral_model,parms=parameters)
plot(out,ylab='N',xlab='time',las=1, xlim=c(0,10))
```



```{r}
parameters <- c(a = 0.2,g=0.8,r=1.0,d=0.44,s=0.49,K=10) #Parameter a increased by .1
out <- ode(y = state,times=times,func=coral_model,parms=parameters)
plot(out,ylab='N',xlab='time',las=1, xlim=c(0,10))

```

We found that changes in parameter a resulted in the largest effect on coral populations, as increases in a, which is the competition between macro-algae and coral, resulted in coral population (N) declining faster. 


# Part B

```{r}

# From Thampi et al. 2018 paper https://www.nature.com/articles/s41598-018-20341-0#Sec6

require(deSolve)
coupled_model <- function(Time, State, Pars) {
  with(as.list(c(State, Pars)), {
    dM <-  a*M*C - (P*M)/(M+T) + gamma*M*T
    dC <-  r*T*C - d*C - a*M*C
    dT <- (P*M)/(M+T) - gamma*M*T - r*T*C + d*C
    dP <- s*P*(1 - P/C) - sigma*P*(1 - X)
    dX <- kappa*X*(1 - X)*(-1 + j*(1 - C) - sigma*P*(1 - X) + phi*(2*X - 1))
    return(list(c(dM,dC,dT,dP,dX)))  
  })
}

pars <- c(a = 0.1, gamma = 0.8, r = 1.0, d = 0.44, s = 0.49, sigma = 0.5, kappa= 1.014, j=1.68, sigma = 0.5, phi = 0.2)


yini  <- c(M = 0.05, C = 0.9, T = 0.05, P = 0.4, X = 0.5)
times <- seq(0, 100, by = 0.1)
out   <- ode(yini, times, coupled_model, pars)
plot(out, ylab="N", xlab="time")
```
